# links = [
#     'http://35.223.170.90:8080/tasks/20/jobs/20',
#     'http://35.223.170.90:8080/tasks/24/jobs/24',
#     'http://35.223.170.90:8080/tasks/25/jobs/25',
#     'http://35.223.170.90:8080/tasks/26/jobs/26',
#     'http://35.223.170.90:8080/tasks/115',
#     'http://35.223.170.90:8080/tasks/113',
#     'http://35.223.170.90:8080/tasks/111',
#     'http://35.223.170.90:8080/tasks/29/jobs/29',
#     'http://35.223.170.90:8080/tasks/35',
#     'http://35.223.170.90:8080/tasks/36/jobs/36',
#     'http://35.223.170.90:8080/tasks/34',
#     'http://35.223.170.90:8080/tasks/38',
#     'http://35.223.170.90:8080/tasks/43',
#     'http://35.223.170.90:8080/tasks/44',
#     'http://35.223.170.90:8080/tasks/61',
#     'http://35.223.170.90:8080/tasks/64/jobs/64',
#     'http://35.223.170.90:8080/tasks/62',
#     'http://35.223.170.90:8080/tasks/66',
#     'http://35.223.170.90:8080/tasks/112',
#     'http://35.223.170.90:8080/tasks/69',
#     'http://35.223.170.90:8080/tasks/47',
#     'http://35.223.170.90:8080/tasks/37',
#     'http://35.223.170.90:8080/tasks/116/jobs/116',
#     'http://35.223.170.90:8080/tasks/28/jobs/28',
#     'http://35.223.170.90:8080/tasks/114',
#     'http://35.223.170.90:8080/tasks/72',
#     'http://35.223.170.90:8080/tasks/71',
#     'http://35.223.170.90:8080/tasks/67',
#     'http://35.223.170.90:8080/tasks/68',
#     'http://35.223.170.90:8080/tasks/88',
#     'http://35.223.170.90:8080/tasks/46',
#     'http://35.223.170.90:8080/tasks/51',
#     'http://35.223.170.90:8080/tasks/70',
#     'http://35.223.170.90:8080/tasks/60',
#     'http://35.223.170.90:8080/tasks/41',
#     'http://35.223.170.90:8080/tasks/21/jobs/21',
#     'http://35.223.170.90:8080/tasks/81',
#     'http://35.223.170.90:8080/tasks/87',
#     'http://35.223.170.90:8080/tasks/84',
# ]

# links = [
#     'http://35.223.170.90:8080/api/tasks/20/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/24/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/25/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/26/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/115/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/113/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/111/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/29/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/35/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/36/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/34/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/38/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/43/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/44/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/61/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/64/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/62/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/66/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/112/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/69/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/47/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/37/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/116/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/28/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/114/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/72/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/71/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/67/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/68/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/88/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/46/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/51/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/70/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/60/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/41/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/21/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/81/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/87/dataset?org=INDIKA&format=Segmentation+mask+1.1',
#     'http://35.223.170.90:8080/api/tasks/84/dataset?org=INDIKA&format=Segmentation+mask+1.1',
# ]

# # http://35.223.170.90:8080/api/tasks/36/dataset?org=INDIKA&format=Segmentation+mask+1.1&action=download

# import webbrowser

# import requests

# for link in links:
#     # x = requests.get(link)
#     webbrowser.open(link)
#     # print(x)
#     pass


import argparse
import os
import json
import webbrowser

def get_arguments():

	"""Parse all the arguments provided from the CLI.	
	Returns:
	A list of parsed arguments.
	"""
	
	parser = argparse.ArgumentParser(description="Pipeline to generate 3D cloth")	
	# Format inputs
	
	parser.add_argument("--cvat-path", type=str, required = True)
	parser.add_argument("--format", type=str,  default = "Segmentation mask 1.1")
	parser.add_argument("--batch", type=str)
	
	
	return parser.parse_args()

def download_link(opts, link):
	splits = link.split('/')

	uri, taskid,  = splits[2], splits[4]

	format = '+'.join(opts.format.split(' '))
	resource = f"http://{uri}/api/tasks/{taskid}/dataset?org=INDIKA&format={format}&action=download"

	return resource
	pass

if __name__ == "__main__":

	opts = get_arguments()

	with open(opts.cvat_path, 'r') as fp:
		cvat_metadata = json.load(fp)

	
	links = cvat_metadata[opts.batch]

	for link in links:
		_link = download_link( opts, link )
		webbrowser.open(_link)
	pass